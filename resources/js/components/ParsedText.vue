<template>
    <div v-html="parsedText"></div>
</template>

<script>
export default {
    props: {
        use: {
            type: Array,
            default: () => ['url', 'email']
        },
        text: {
            type: String,
            required: true
        }
    },
    data() {
        return {}
    },
    computed: {
        parsedText() {
            let text = this.text;
            ['url', 'email'].forEach(parser => {
                text = this[`${parser}Parser`](text)
            });
            return text
        }
    },
    methods: {
        urlParser(text) {
            if(text.includes('orcid.org')) {
                return text;
            }
            let urlRegex = /(https?:\/\/[^\s]+)/g;
            return text.replace(urlRegex, url => {
                return `<a
                            class="border-b border-black hover:border-blue-400 hover:text-blue-400 mr-2"
                            target="_blank"
                            href="${url}">
                            Go to link
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 400 400"
                                 class="fill-current w-3 inline-block ml-2 mb-1 h-3" fill="currentColor">
                                <path
                                    d="M263.581 32.745c-7.087 3.218-10.268 12.384-6.688 19.269.876 1.685 10.231 11.675 20.788 22.199l19.194 19.135-71.094 71.109c-54.252 54.265-71.115 71.57-71.183 73.053-.05 1.069-.024 2.646.056 3.506.081.861 6.518 7.962 14.34 15.82l14.193 14.258H190.214L261.324 200l71.11-71.094 19.521 19.533c10.736 10.743 20.713 20.099 22.169 20.79 4.084 1.937 10.901 1.184 14.564-1.61 6.164-4.701 5.899-1.528 5.662-67.822l-.209-58.896-2.097-3.169c-4.514-6.82-1.035-6.484-67.095-6.465-55.107.016-58.321.094-61.368 1.478M53.491 60.842c-22.94 5.644-41.383 24.93-46.039 48.142-1.997 9.956-1.418 202.463.629 209.375 6.142 20.737 23.154 37.764 43.872 43.912 6.913 2.051 200.192 2.584 210.156.579 12.277-2.47 20.804-7.293 30.86-17.458 17.117-17.301 18.715-24.024 18.736-78.816.018-44.334 1.028-41.576-15.228-41.576-8.27 0-9.043.131-11.082 1.885l-2.192 1.884-.39 40.498c-.365 37.773-.493 40.735-1.899 44.014-4.75 11.077-13.247 18.58-24.301 21.459-7.025 1.83-187.624 1.804-195.679-.028-12.71-2.891-23.277-14.12-25.719-27.331-1.419-7.676-1.12-186.01.323-192.821 2.305-10.88 10.568-20.523 21.296-24.855l4.494-1.814 81.905-.391 81.906-.391 1.493-1.844c2.539-3.136 2.217-21.331-.425-23.972l-1.917-1.918-82.653.058c-75.597.052-83.122.172-88.146 1.409"
                                    fill-rule="evenodd"/>
                            </svg>
                        </a>
              `;
            })
        },
        emailParser(text) {
            return text;
        }
    }
}
</script>
